&НаСервере
Процедура ИмпортНаСервере(Результат, ДопПараметр) Экспорт
	Если НЕ(Результат = Неопределено) Тогда
		ИмяФайла = Результат[0];
	Иначе		
	    Сообщить("Файл не выбран!");
		Возврат;
	КонецЕсли;      	
	ТекстДок = Новый ТекстовыйДокумент;
	ТекстДок.Прочитать(ИмяФайла);
	Для Строка = 2 По ТекстДок.КоличествоСтрок() Цикл
		ТекущаяСтрока = ТекстДок.ПолучитьСтроку(Строка);
		МассивДанных = СтрРазделить(ТекущаяСтрока, ",");
		ЭлементПользователь = Справочники.Пользователи.СоздатьЭлемент();
		ЭлементПользователь.Наименование = СокрЛП(МассивДанных[0] + " " + СокрЛП(МассивДанных[1]));
		ЭлементПользователь.Логин = СокрЛП(МассивДанных[2]);
		ЭлементПользователь.Пароль = СокрЛП(МассивДанных[3]);
		Если Справочники.Роли.НайтиПоНаименованию(СокрЛП(МассивДанных[4]), Истина) = Справочники.Роли.ПустаяСсылка() Тогда
			ЭлементРоль = Справочники.Роли.СоздатьЭлемент();
			ЭлементРоль.Наименование = СокрЛП(МассивДанных[4]);
			ЭлементРоль.Записать();
			Сообщить("В справочник Роли добавлена запись " + МассивДанных[4]);			
		КонецЕсли;
		ЭлементПользователь.Роль = Справочники.Роли.НайтиПоНаименованию(ЭлементРоль.Наименование, Истина);
		ЭлементПользователь.Записать();
		Сообщить("В справочник Пользователи добавлена запись " + ЭлементПользователь.Наименование);
	КонецЦикла;	
КонецПроцедуры

&НаКлиенте
Процедура Импорт(Команда) 	
	ВыборФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор=Ложь;
	ВыборФайла.Фильтр = "Текстовые документы *.csv | *.csv";           
	ВыборФайла.Показать(Новый ОписаниеОповещения("ИмпортНаСервере", ЭтотОбъект, Новый Структура));
КонецПроцедуры
