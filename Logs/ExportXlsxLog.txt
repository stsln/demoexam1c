// В форме списка справочника Фурнитура
&НаСервере 
Процедура ЗагрузитьДанныеНаСервере(Результат, ДопПараметр) Экспорт
	// Если файл выбран, то получим его (индексы идут с 0)
	Если НЕ(Результат = Неопределено) Тогда
		СсылкаНаФайл = Результат[0];
	Иначе
		Сообщить("Файл не выбран");
		Возврат;		
	КонецЕсли;
	// Преобразуем полученные данные в табличный документ для дальнейшей работы
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.Прочитать(СсылкаНаФайл);
	
	// Чтение данных начиная со второй строки, т.к. первая это заголовки
	Для Строка = 2 По ТабДок.ВысотаТаблицы Цикл
		ЭлементФурнитура = Справочники.Фурнитура.СоздатьЭлемент();
		
		Если Справочники.Фурнитура.НайтиПоНаименованию(ТабДок.Область(Строка, 2).Текст) <> Справочники.Фурнитура.ПустаяСсылка() Тогда
			Сообщить("В справочнике уже имеется запись " + ТабДок.Область(Строка, 2).Текст);
			Продолжить;	
		КонецЕсли;
		Артикул = СокрЛП(ТабДок.Область(Строка, 1).Текст);
		Наименование = СокрЛП(ТабДок.Область(Строка, 2).Текст);
		Количество = СокрЛП(ТабДок.Область(Строка, 3).Текст);
		ЕдИзм = СокрЛП(ТабДок.Область(Строка, 4).Текст);
		ТипФур = СокрЛП(ТабДок.Область(Строка, 5).Текст);
		Цена = СокрЛП(ТабДок.Область(Строка, 6).Текст); 		
		// Установим артикул, наименование, количество и цену
		ЭлементФурнитура.Артикул = Артикул;
		ЭлементФурнитура.Наименование = Наименование; 		
		ЭлементФурнитура.Количество = Количество;   
		ЭлементФурнитура.Цена = Цена;
		// Если ее нет в справочнике, то добавим
		Если Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдИзм, Истина) = Справочники.ЕдиницыИзмерения.ПустаяСсылка() Тогда
			ЭлементЕдИзм = Справочники.ЕдиницыИзмерения.СоздатьЭлемент();
			ЭлементЕдИзм.Наименование = ЕдИзм;
			ЭлементЕдИзм.Записать();
			Сообщить("В справочник Единица Измерения добавлена запись " + ЭлементЕдИзм.Наименование);
		КонецЕсли;                                                                                     		
		// Установим единицу измерения по ссылке из справочника
		ЭлементФурнитура.ЕдиницаИзмерения = Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдИзм, Истина);  		
		// Если ее нет в справочнике, то добавим
		Если Справочники.ТипыФурнитуры.НайтиПоНаименованию(ТипФур, Истина) = Справочники.ТипыФурнитуры.ПустаяСсылка() Тогда
			ЭлементТипФур = Справочники.ТипыФурнитуры.СоздатьЭлемент();
			ЭлементТипФур.Наименование = ТипФур;
			ЭлементТипФур.Записать();
			Сообщить("В справочник Тип Форнитуры добавлена запись " + ЭлементТипФур.Наименование);
		КонецЕсли;
		// Установим тип фурнитуры по ссылке из справочника
		ЭлементФурнитура.ТипФурнитуры = Справочники.ТипыФурнитуры.НайтиПоНаименованию(ТипФур, Истина);    					
		ЭлементФурнитура.Записать();
		Сообщить("В справочник Фурнитура добавлена запись " + Наименование);
	КонецЦикла;   
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьДанные(Команда)
	// Получим файл в формате xlsx
	ВыборФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор = Ложь;
	ВыборФайла.Фильтр = "Табличные документы *.xlsx | *.xlsx";
	// После выбора файла вызовем процедуру импорта на сервере
	ВыборФайла.Показать(Новый ОписаниеОповещения("ЗагрузитьДанныеНаСервере", ЭтаФорма, Новый Структура)); 
КонецПроцедуры