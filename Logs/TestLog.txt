// Форма обработки ЗапускТестов
&НаКлиенте
Процедура ПлатформаНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	Диалог = Новый ДиалогВыбораФайла (РежимДиалогаВыбораФайла.Открытие);
	Диалог.Заголовок = "Выберите файл базы 1С";
	Диалог.ПредварительныйПросмотр = Ложь;
	Диалог.МножественныйВыбор = Ложь;
	Диалог.ПроверятьСуществованиеФайла = Истина;
	Диалог.Каталог = "c:\";
	Если Диалог.Выбрать() Тогда
		Платформа = Диалог.ПолноеИмяФайла;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ПутьКБазеНачалоВыбора (Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);
	Диалог.Заголовок = "Выберите путь к базе для тестирования";
	Диалог.МножественныйВыбор = Ложь;
	Диалог.Каталог = "";
	Если Диалог.Выбрать() Тогда
		ПутьКБазе = Диалог.Каталог;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ТестовыйСценарий1(Команда)
	// Путь к платформе
	// C:\Program Files\lcv8\8.3.19.1264\bin\lcv8.exe
	// ""Платформа""

	// Ключ запуска платформы
	// Enterprise

	// Путь к базе:
	//		/F ""C:\Users\current_user\Documents\Клиент-Тестирования""
	// 		/F " + ПутьКБазе + "

	// Имя пользователя:
	// 		/N " + ИмяПользователя +"

	// Пароль:
	//		/P

	// Ключ команда запуска клиента тестирования
	// 		/TESTCLIENT

	ЗапуститьСистему("""Платформа"" ENTERPRISE /F " + ПутьКБазе + " /TESTCLIENT");
	ТестируемоеПриложение = Новый ТестируемоеПриложение();
	МаксИтераций = 10;
	Для Счетчик = 1 По МаксИтераций Цикл
		Попытка
			ТестируемоеПриложение.УстановитьСоединение();
			Прервать;
		Исключение
			Если Счетчик = МаксИтераций Тогда
				Сообщить(ОписаниеОшибки());
			КонецЕсли;
		КонецПопытки;
	КонецЦикла;
	
	ГлавноеОкноФормы = ТестируемоеПриложение.НайтиОбъект(Тип("ТестируемоеОкноКлиентскогоПриложения"));
	КомандныйИнтерфейсГлавногоОкна = ГлавноеОкноформы.ПолучитьКомандныйИнтерфейс();
	КнопкаФурнитура = КомандныйИнтерфейсГлавногоОкна.НайтиОбъект(Тип("ТестируемаяКнопкаКомандногоИнтерфейса"), "Фурнитура");
	КнопкаФурнитура.Нажать();
	
	ОкноПриложенияФурнитура = ТестируемоеПриложение.НайтиОбъект(Тип("ТестируемоеОкноКлиентскогоПриложения"), "Фурнитура");
	ФормаФурнитура = ОкноПриложенияФурнитура.Найтиобъект (Тип ("ТестируемаяФорма"),"Фурнитура");
	КнопкаСоздать = Формафурнитура.НайтиОбъект(Тип("ТестируемаяКнопкаФормы"), "Создать");
	КнопкаСоздать.Нажать();
	
	ОкноПриложенияФурнитураСоздание = ТестируемоеПриложение.НайтиОбъект(Тип("ТестируемоеОкноКлиентскогоПриложения"), "Фурнитура (создание)");
	ФормаФурнитураСоздание = ОкноПриложенияФурнитураСоздание.НайтиОбъект(Тип("ТестируемаяФорма"), "Фурнитура (создание) ");
	ПолеНаименование = ФормаФурнитураСоздание.НайтиОбъект(Тип ("ТестируемоеПолеФормы"), "Наименование");
	ПолеНаименование.ВвестиТекст ("П-образый Кронштейн");
	
	ПолеКоличество = ОкноПриложенияФурнитураСоздание. НайтиОбъект(Тип("ТестируемоеПолеФормы"), "Количество");
	ПолеКоличество.Активизировать();
	ПолеКоличество.ВвестиТекст("1");
	
	ПолеЕдиницаИзмерения = ОкноПриложенияФурнитураСоздание.НайтиОбъект(Тип("ТестируеноеПолеФормы"), "Единица измерения");
	ПолеЕдиницаИзмерения.Активизировать();
	ПолеЕдиницаИзмерения.ОткрытьВыпадающийСписок(); 
	ПолеЕдиницаИзмерения.Выбрать();
	
	ОкноПриложенияЕдиницаИзменрения = ТестируемоеПриложение. НайтиОбъект (Тип ("ТестируемоеОкноКлиентскогоПриложения"),"Единица изменрения");
	ОкноПриложенияЕдиницаИзменренияФормаЕдиницаИзмерения = ОкноПриложенияЕдиницаИзменрения.НайтиОбъект(Тип("ТестируемаяФорма"), "Единица изненрения");
	
	ТаблицаСписок = ОкноПриложенияЕдиницаИзменрения.Найтиобъект(Тип("ТестируемаяТаблицаФормы"), "Список");
	ОписаниеСтроки = Новый Соответствие();
	ОписаниеСтроки.Вставить("Код", "000000001");
	ОписаниеСтроки.Вставить("Наименование", "шт");
	ТаблицаСписок.ПерейтиКСтроке(ОписаниеСтроки, НаправлениеПереходаКСтроке.Вниз);
	ТаблицаСписок.Выбрать();
	
	ПолеТип = ОкноПриложенияФурнитураСоздание.НайтиОбъект(Тип("ТестируемоеПолеФормы"), "Тип");
	ПолеТип.Активизировать();
	ПолеТип.Выбрать();
	
	ОкноПриложенияТипФурнитуры = ТестируемоеПриложение. НайтиОбъект (Тип("ТестируемоеОкноКлиентскогоПриложения"),"Тип фурнитуры");
	ОкноПриложенияТипФурнитурыформаТипФурнитуры = ОкноПриложенияТипфурнитуры. НайтиОбъект (Тип("ТестируемаяФорма"),"Тип фурнитуры") ;
	ТаблицаСписок = ОкноПриложенияТипфурнитурыформаТипфурнитуры. НайтиОбъект (Тип ("ТестируемаяТаблицаФормы") , "Список");
	ОписаниеСтроки = Новый Соответствие();
	ОписаниеСтроки.Вставить ("Код", "000000007");
	ОписаниеСтроки.Вставить ("Наименование", "Крепления и соединители");
	ТаблицаСписок.ПерейтиКСтроке(ОписаниеСтроки, НаправлениеПереходаКСтроке.Вниз);
	ТаблицаСписок.Выбрать();
	
	ПолеЦена = ОкноПриложенияФурнитураСоздание.Найтиобъект(Тип("ТестируемоеПолеФормы"), "Цена");
	ПолеЦена.Активизировать();
	ПолеЦена.ВвестиТекст("382,00");
	КнопкаЗаписатьИЗакрыть = ОкноПриложенияФурнитураСоздание.НайтиОбъект(Тип("ТестируемаяКнопкаФормы"), "Записать и закрыть");
	КнопкаЗаписатьИЗакрыть.Нажать();


КонецПроцедуры